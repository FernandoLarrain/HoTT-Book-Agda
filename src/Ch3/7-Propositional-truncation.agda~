{-# OPTIONS --without-K --exact-split #-}

open import Ch1.Type-theory
open import Ch2.Homotopy-type-theory
open import Ch3.3-Mere-propositions

module Ch3.7-Propositional-truncation where


-- Definition of propositional truncations

record propositional-truncations-exist : ğ“¤Ï‰ where
  field
    âˆ¥_âˆ¥ : {ğ“¤ : Universe} â†’ ğ“¤ Ì‡ â†’ ğ“¤ Ì‡
    âˆ¥âˆ¥-is-Prop : {ğ“¤ : Universe} {X : ğ“¤ Ì‡ } â†’ isProp âˆ¥ X âˆ¥
    âˆ£_âˆ£ : {ğ“¤ : Universe} {X : ğ“¤ Ì‡ } â†’ X â†’ âˆ¥ X âˆ¥
    âˆ¥âˆ¥-recursion : {ğ“¤ ğ“¥ : Universe} {X : ğ“¤ Ì‡ } {P : ğ“¥ Ì‡ } â†’ isProp P â†’ (X â†’ P) â†’ âˆ¥ X âˆ¥ â†’ P
  infix 0 âˆ¥_âˆ¥


{- Propositional truncations are assumed to exist via modules. -}

module basic-truncation-development (pt : propositional-truncations-exist) where

  open propositional-truncations-exist pt public


  -- Computation rule for âˆ¥âˆ¥-recursion

  âˆ¥âˆ¥-recursion-computation : {X : ğ“¤ Ì‡ } {P :  ğ“¥ Ì‡ } â†’ (i : isProp P) â†’ (f : X â†’ P) â†’ (x : X) â†’ âˆ¥âˆ¥-recursion i f âˆ£ x âˆ£ â‰¡ f x
  âˆ¥âˆ¥-recursion-computation i f x = i (âˆ¥âˆ¥-recursion i f âˆ£ x âˆ£) (f x)


  -- âˆ¥âˆ¥-induction

  âˆ¥âˆ¥-induction : {X : ğ“¤ Ì‡ } {P : âˆ¥ X âˆ¥ â†’ ğ“¥ Ì‡ } â†’ ((s : âˆ¥ X âˆ¥) â†’ isProp (P s)) â†’ ((x : X) â†’ P âˆ£ x âˆ£) â†’ (s : âˆ¥ X âˆ¥) â†’ P s
  âˆ¥âˆ¥-induction {ğ“¤} {ğ“¥} {X} {P} i f s = Ï†' s
   where
    Ï† : X â†’ P s
    Ï† x = transport P (âˆ¥âˆ¥-is-Prop âˆ£ x âˆ£ s) (f x)
    Ï†' : âˆ¥ X âˆ¥ â†’ P s
    Ï†' = âˆ¥âˆ¥-recursion (i s) Ï†


  -- Computation rule for âˆ¥âˆ¥-induction

  âˆ¥âˆ¥-computation : {X : ğ“¤ Ì‡ } {P : âˆ¥ X âˆ¥ â†’ ğ“¥ Ì‡ } â†’ (i : (s : âˆ¥ X âˆ¥) â†’ isProp (P s)) â†’ (f : (x : X) â†’ P âˆ£ x âˆ£) â†’ (x : X) â†’ âˆ¥âˆ¥-induction i f âˆ£ x âˆ£ â‰¡ f x
  âˆ¥âˆ¥-computation i f x = i âˆ£ x âˆ£ (âˆ¥âˆ¥-induction i f âˆ£ x âˆ£) (f x)


  -- Traditional logical connectives


  -- (i) Disjunction

  -- Definition
  
  _âˆ¨_ : ğ“¤ Ì‡ â†’ ğ“¥ Ì‡ â†’ ğ“¤ âŠ” ğ“¥ Ì‡
  A âˆ¨ B = âˆ¥ A + B âˆ¥

  infixl 20 _âˆ¨_

  -- Closure

  âˆ¨-is-Prop : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } â†’ isProp (A âˆ¨ B)
  âˆ¨-is-Prop = âˆ¥âˆ¥-is-Prop

  -- Disjunction elimination

  âˆ¨-induction : {X : ğ“¤ Ì‡ } {Y : ğ“¥ Ì‡ } (A : X âˆ¨ Y â†’ ğ“¦ Ì‡ ) â†’ ((z : X âˆ¨ Y) â†’ isProp (A z)) â†’ ((x : X) â†’ A (âˆ£ inl x âˆ£)) â†’ ((y : Y) â†’ A (âˆ£ inr y âˆ£)) â†’ (z : X âˆ¨ Y) â†’ A z
  âˆ¨-induction A i f g = âˆ¥âˆ¥-induction i (+-induction (A âˆ˜ âˆ£_âˆ£) f g)
 
  âˆ¨-recursion : {X : ğ“¤ Ì‡ } {Y : ğ“¥ Ì‡ } {A : ğ“¦ Ì‡ } â†’ isProp A â†’ (X â†’ A) â†’ (Y â†’ A) â†’ X âˆ¨ Y â†’ A
  âˆ¨-recursion {X = X} {Y} {A} i f g = âˆ¥âˆ¥-recursion i (+-recursion f g)


  -- (ii) Existential quantifier

  -- Definition
  
  âˆƒ : {X : ğ“¤ Ì‡ } â†’ (X â†’ ğ“¥ Ì‡ ) â†’ ğ“¤ âŠ” ğ“¥ Ì‡
  âˆƒ A = (âˆ¥ Î£ A âˆ¥)
 
  -âˆƒ : {ğ“¤ ğ“¥ : Universe} (X : ğ“¤ Ì‡ ) (Y : X â†’ ğ“¥ Ì‡ ) â†’ ğ“¤ âŠ” ğ“¥ Ì‡
  -âˆƒ X Y = âˆƒ Y

  syntax -âˆƒ A (Î» x â†’ b) = âˆƒ x ê‰ A , b

  infixr -1 -âˆƒ

  -- Closure
  
  âˆƒ-is-Prop : {X : ğ“¤ Ì‡ } {A : X â†’ ğ“¥ Ì‡ } â†’ isProp (âˆƒ A)
  âˆƒ-is-Prop = âˆ¥âˆ¥-is-Prop

  -- Existential elimination

  âˆƒ-induction : {X : ğ“¤ Ì‡ } {Y : X â†’ ğ“¥ Ì‡ } {A : âˆƒ Y â†’ ğ“¦ Ì‡ } â†’ ((z : âˆƒ Y) â†’ isProp (A z)) â†’ ((x : X) (y : Y x) â†’ A âˆ£ (x , y) âˆ£) â†’ (z : âˆƒ Y) â†’ A z
  âˆƒ-induction i g = âˆ¥âˆ¥-induction i (Î£-induction g)
