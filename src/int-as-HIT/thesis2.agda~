{-# OPTIONS --without-K --exact-split #-}

open import Ch1.Type-theory
open import Ch2.Homotopy-type-theory
open import Ch3.Sets-and-logic
open import Ch4.Equivalences
open import Ch5.8-Id-types-and-id-systems

module int-as-HIT.thesis where

postulate
  instance
    fe : FunExt
    univ : Univalence

-- I. The (Wild) Category of â„¤-Algebras

module â„¤-Algebras where

  -- Objects

  AlgStr : ğ“¤ Ì‡ â†’ ğ“¤ Ì‡
  AlgStr A = A Ã— (Î£ s ê‰ (A â†’ A) , ishae s)
  
  Alg : (ğ“¤ : Universe) â†’ ğ“¤ âº Ì‡
  Alg ğ“¤ = Î£ A ê‰ (ğ“¤ Ì‡) , AlgStr A

  -- Morphisms

  HomStr : (A : Alg ğ“¤) (B : Alg ğ“¥) â†’ (prâ‚ A â†’ prâ‚ B) â†’ ğ“¤ âŠ” ğ“¥ Ì‡
  HomStr (A , aâ‚€ , s , i) (B , bâ‚€ , t , j) f = (f aâ‚€ â‰¡ bâ‚€) Ã— (f âˆ˜ s âˆ¼ t âˆ˜ f)
  
  Hom : Alg ğ“¤ â†’ Alg ğ“¥ â†’ ğ“¤ âŠ” ğ“¥ Ì‡
  Hom A B = Î£ f ê‰ (prâ‚ A â†’ prâ‚ B) , HomStr A B f 

  -- Composition

  comp : (A : Alg ğ“¤) (B : Alg ğ“¥) (C : Alg ğ“¦) â†’ Hom B C â†’ Hom A B â†’ Hom A C
  comp A B C (g , gâ‚€ , g-s) (f , fâ‚€ , f-Î²) = g âˆ˜ f , (ap g fâ‚€ âˆ™ gâ‚€) , Î» a â†’ ap g (f-Î² a) âˆ™ g-s (f a)

  -- Identity

  algid : (A : Alg ğ“¤) â†’ Hom A A
  algid A = id , refl _ , hrefl _

open â„¤-Algebras public
