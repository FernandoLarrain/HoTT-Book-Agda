{-# OPTIONS --without-K --exact-split --safe #-}

open import Ch1.Type-theory
open import Ch2.Homotopy-type-theory
open import Ch3.Sets-and-logic
open import Ch4.Equivalences
open import Ch5.8-Id-types-and-id-systems

module int-as-HIT.thesis where


-- I. â„•- and â„¤-Algebras

â„•Alg : (ğ“¤ : Universe) â†’ ğ“¤ âº Ì‡
â„•Alg ğ“¤ = Î£ A ê‰ (ğ“¤ Ì‡) , A Ã— (A â†’ A)

â„¤Alg : (ğ“¤ : Universe) â†’ ğ“¤ âº Ì‡
â„¤Alg ğ“¤ = Î£ A ê‰ (ğ“¤ Ì‡) , A Ã— (Î£ s ê‰ (A â†’ A) , ishae s)

{- Notation:

â„¤Alg ğ“¤ = Î£ A ê‰ (ğ“¤ Ì‡) ,
         Î£ aâ‚€ ê‰ A ,
         Î£ s ê‰ (A â†’ A) ,
         Î£ p ê‰ (A â†’ A) ,
         Î£ Ïƒ ê‰ (p âˆ˜ s âˆ¼ id) ,
         Î£ Ï ê‰ (s âˆ˜ p âˆ¼ id) ,
         ((a : A) â†’ ap s (Ïƒ a) â‰¡ Ï (s a)) -- Ï„

-}


-- II. â„•- and â„¤-Algebra Homomorphisms

-- Equivalences as objects

Eqv : (ğ“¤ : Universe) â†’ ğ“¤ âº Ì‡
Eqv ğ“¤ = Î£ Aâ‚ ê‰ (ğ“¤ Ì‡) , Î£ Aâ‚‚ ê‰ (ğ“¤ Ì‡) , Aâ‚ â‰ƒ Aâ‚‚

-- Equivalence-preserving maps

module EqvPreservation {Aâ‚ Aâ‚‚ : ğ“¤ Ì‡} {Bâ‚ Bâ‚‚ : ğ“¥ Ì‡} (fâ‚ : Aâ‚ â†’ Bâ‚) (fâ‚‚ : Aâ‚‚ â†’ Bâ‚‚) where

  module MapPreservation where

    s-pres : (Aâ‚ â†’ Aâ‚‚) â†’ (Bâ‚ â†’ Bâ‚‚) â†’ ğ“¤ âŠ” ğ“¥ Ì‡
    s-pres s s' = fâ‚‚ âˆ˜ s âˆ¼ s' âˆ˜ fâ‚

    p-pres : (Aâ‚‚ â†’ Aâ‚) â†’ (Bâ‚‚ â†’ Bâ‚) â†’ ğ“¤ âŠ” ğ“¥ Ì‡
    p-pres p p' = fâ‚ âˆ˜ p âˆ¼ p' âˆ˜ fâ‚‚

  open MapPreservation public

  module HtpyPreservation (s : Aâ‚ â†’ Aâ‚‚) (p : Aâ‚‚ â†’ Aâ‚) (s' : Bâ‚ â†’ Bâ‚‚) (p' : Bâ‚‚ â†’ Bâ‚) (Î± : s-pres s s') (Î² : p-pres p p') where

    aux-Î³ : fâ‚ âˆ˜ p âˆ˜ s âˆ¼ p' âˆ˜ s' âˆ˜ fâ‚
    aux-Î³ aâ‚ = Î² (s aâ‚) âˆ™ ap p' (Î± aâ‚)

    Ïƒ-pres : (p âˆ˜ s âˆ¼ id) â†’ (p' âˆ˜ s' âˆ¼ id) â†’ ğ“¤ âŠ” ğ“¥ Ì‡
    Ïƒ-pres Ïƒ Ïƒ' = (aâ‚ : Aâ‚) â†’ ap fâ‚ (Ïƒ aâ‚) â‰¡ aux-Î³ aâ‚ âˆ™ Ïƒ' (fâ‚ aâ‚)

    aux-Î´ : fâ‚‚ âˆ˜ s âˆ˜ p âˆ¼ s' âˆ˜ p' âˆ˜ fâ‚‚
    aux-Î´ aâ‚‚ = Î± (p aâ‚‚) âˆ™ ap s' (Î² aâ‚‚)

    Ï-pres : (s âˆ˜ p âˆ¼ id) â†’ (s' âˆ˜ p' âˆ¼ id) â†’ ğ“¤ âŠ” ğ“¥ Ì‡
    Ï-pres Ï Ï' = (aâ‚‚ : Aâ‚‚) â†’ ap fâ‚‚ (Ï aâ‚‚) â‰¡ aux-Î´ aâ‚‚ âˆ™ Ï' (fâ‚‚ aâ‚‚)

  module CohPreservation (s : Aâ‚ â†’ Aâ‚‚) (p : Aâ‚‚ â†’ Aâ‚) (s' : Bâ‚ â†’ Bâ‚‚) (p' : Bâ‚‚ â†’ Bâ‚) (Î± : s-pres s s') (Î² : p-pres p p') where

    open HtpyPreservation s p s' p' Î± Î²

    aux-Îµ-Î³â‚ : fâ‚‚ âˆ˜ s âˆ˜ p âˆ˜ s âˆ¼ s' âˆ˜ p' âˆ˜ s' âˆ˜ fâ‚
    aux-Îµ-Î³â‚ aâ‚ = Î± (p (s aâ‚)) âˆ™ ap s' (aux-Î³ aâ‚)

    aux-Îµ-Î´â‚ : fâ‚‚ âˆ˜ s âˆ˜ p âˆ˜ s âˆ¼ s' âˆ˜ p' âˆ˜ s' âˆ˜ fâ‚
    aux-Îµ-Î´â‚ aâ‚ = aux-Î´ (s aâ‚) âˆ™ ap s' (ap p' (Î± aâ‚))

    aux-Îµ-Î³â‚-is-aux-Îµ-Î´â‚ : aux-Îµ-Î³â‚ âˆ¼ aux-Îµ-Î´â‚
    aux-Îµ-Î³â‚-is-aux-Îµ-Î´â‚ aâ‚ = (refl (Î± (p (s aâ‚))) âœ¦ ap-âˆ™ s' _ _) âˆ™ âˆ™-assoc _ _ _

    aux-Îµ-Î³â‚‚ : (Ïƒ : p âˆ˜ s âˆ¼ id) (Ïƒ' : p' âˆ˜ s' âˆ¼ id) â†’ ((aâ‚ : Aâ‚) â†’ ap fâ‚ (Ïƒ aâ‚) â‰¡ aux-Î³ aâ‚ âˆ™ Ïƒ' (fâ‚ aâ‚)) â†’ (aâ‚ : Aâ‚) â†’ ap fâ‚‚ (ap s (Ïƒ aâ‚)) âˆ™ Î± aâ‚ â‰¡ aux-Îµ-Î³â‚ aâ‚ âˆ™ ap s' (Ïƒ' (fâ‚ aâ‚))
    aux-Îµ-Î³â‚‚ Ïƒ Ïƒ' Î³ aâ‚ = (ap-âˆ˜ s fâ‚‚ (Ïƒ aâ‚) âœ¦ refl (Î± aâ‚)) âˆ™ hnat Î± (Ïƒ aâ‚) â»Â¹ âˆ™ (refl (Î± (p (s aâ‚))) âœ¦ (ap-âˆ˜ fâ‚ s' (Ïƒ aâ‚) â»Â¹ âˆ™ ap (ap s') (Î³ aâ‚) âˆ™ ap-âˆ™ s' _ _)) âˆ™ âˆ™-assoc _ _ _

    aux-Îµ-Î´â‚‚ : (Ï : s âˆ˜ p âˆ¼ id) (Ï' : s' âˆ˜ p' âˆ¼ id) â†’ ((aâ‚‚ : Aâ‚‚) â†’ ap fâ‚‚ (Ï aâ‚‚) â‰¡ aux-Î´ aâ‚‚ âˆ™ Ï' (fâ‚‚ aâ‚‚)) â†’ (aâ‚ : Aâ‚) â†’ ap fâ‚‚ (Ï (s aâ‚)) âˆ™ Î± aâ‚ â‰¡ aux-Îµ-Î´â‚ aâ‚ âˆ™ Ï' (s' (fâ‚ aâ‚))
    aux-Îµ-Î´â‚‚ Ï Ï' Î´ aâ‚ = (Î´ (s aâ‚) âœ¦ ap-id (Î± aâ‚) â»Â¹) âˆ™ âˆ™-assoc _ _ _ â»Â¹ âˆ™ (refl (aux-Î´ (s aâ‚)) âœ¦ (hnat Ï' (Î± aâ‚) âˆ™ (ap-âˆ˜ p' s' (Î± aâ‚) â»Â¹ âœ¦ refl (Ï' (s' (fâ‚ aâ‚)))))) âˆ™ âˆ™-assoc _ _ _

    Ï„-pres : (Ïƒ : p âˆ˜ s âˆ¼ id) (Ï : s âˆ˜ p âˆ¼ id) (Ï„ : (aâ‚ : Aâ‚) â†’ ap s (Ïƒ aâ‚) â‰¡ Ï (s aâ‚)) (Ïƒ' : p' âˆ˜ s' âˆ¼ id) (Ï' : s' âˆ˜ p' âˆ¼ id) (Ï„' : (bâ‚ : Bâ‚) â†’ ap s' (Ïƒ' bâ‚) â‰¡ Ï' (s' bâ‚)) (Î³ : Ïƒ-pres Ïƒ Ïƒ') (Î´ : Ï-pres Ï Ï') â†’ ğ“¤ âŠ” ğ“¥ Ì‡
    Ï„-pres Ïƒ Ï Ï„ Ïƒ' Ï' Ï„' Î³ Î´ = (aâ‚ : Aâ‚) â†’ (ap (ap fâ‚‚) (Ï„ aâ‚) âœ¦ refl (Î± aâ‚)) âˆ™ aux-Îµ-Î´â‚‚ Ï Ï' Î´ aâ‚ â‰¡ aux-Îµ-Î³â‚‚ Ïƒ Ïƒ' Î³ aâ‚ âˆ™ (aux-Îµ-Î³â‚-is-aux-Îµ-Î´â‚ aâ‚ âœ¦ Ï„' (fâ‚ aâ‚))

hae-pres : (A : Eqv ğ“¤) (B : Eqv ğ“¥) â†’ (prâ‚ A â†’ prâ‚ B) â†’ (prâ‚ (prâ‚‚ A) â†’ prâ‚ (prâ‚‚ B)) â†’ ğ“¤ âŠ” ğ“¥ Ì‡
hae-pres (Aâ‚ , Aâ‚‚ , s , p , Ïƒ , Ï , Ï„) (Bâ‚ , Bâ‚‚ , s' , p' , Ïƒ' , Ï' , Ï„') fâ‚ fâ‚‚ =
  Î£ Î± ê‰ s-pres s s' ,
  Î£ Î² ê‰ p-pres p p' ,
  Î£ Î³ ê‰ Ïƒ-pres Î± Î² Ïƒ Ïƒ' ,
  Î£ Î´ ê‰ Ï-pres Î± Î² Ï Ï' ,
  Ï„-pres Î± Î² Ïƒ Ï Ï„ Ïƒ' Ï' Ï„' Î³ Î´
  where open EqvPreservation fâ‚ fâ‚‚
        open HtpyPreservation s p s' p'
        open CohPreservation s p s' p'

hae-semipres : (A : Eqv ğ“¤) (B : Eqv ğ“¥) (fâ‚ : prâ‚ A â†’ prâ‚ B) (fâ‚‚ : prâ‚ (prâ‚‚ A) â†’ prâ‚ (prâ‚‚ B)) â†’ EqvPreservation.s-pres fâ‚ fâ‚‚ (prâ‚ (prâ‚‚ (prâ‚‚ A))) (prâ‚ (prâ‚‚ (prâ‚‚ B))) â†’ ğ“¤ âŠ” ğ“¥ Ì‡
hae-semipres (Aâ‚ , Aâ‚‚ , s , p , Ïƒ , Ï , Ï„) (Bâ‚ , Bâ‚‚ , s' , p' , Ïƒ' , Ï' , Ï„') fâ‚ fâ‚‚ Î± =
  Î£ Î² ê‰ p-pres p p' ,
  Î£ Î³ ê‰ Ïƒ-pres Î² Ïƒ Ïƒ' ,
  Î£ Î´ ê‰ Ï-pres Î² Ï Ï' ,
  Ï„-pres Î² Ïƒ Ï Ï„ Ïƒ' Ï' Ï„' Î³ Î´
  where open EqvPreservation fâ‚ fâ‚‚
        open HtpyPreservation s p s' p' Î±
        open CohPreservation s p s' p' Î±

EqvHom : Eqv ğ“¤ â†’ Eqv ğ“¥ â†’ ğ“¤ âŠ” ğ“¥ Ì‡
EqvHom A B = Î£ fâ‚ ê‰ (prâ‚ A â†’ prâ‚ B) , Î£ fâ‚‚ ê‰ (prâ‚ (prâ‚‚ A) â†’ prâ‚ (prâ‚‚ B)) , hae-pres A B fâ‚ fâ‚‚

-- Simple equivalence-preserving maps

module SimpleHom â¦ƒ fe : FunExt â¦„ (A : ğ“¤ Ì‡) (B : ğ“¥ Ì‡) (f : A â†’ B) where

  open EqvPreservation f f
  open HtpyPreservation id id id id
  open CohPreservation id id id id

  abstract
  
    lemma-1 : isContr (Î£ Î² ê‰ p-pres id id , Ïƒ-pres (hrefl _) Î² (hrefl _) (hrefl _))
    lemma-1 = â‰ƒ-preserves-Contr
      (split , (dep-Î£-UMP A (Î» a â†’ f a â‰¡ f a) Î» a Î²a â†’ refl (f a) â‰¡ (Î²a âˆ™ refl (f a)) âˆ™ refl (f a)))
      (Î -preserves-Contr _ (Î» a â†’ â‰ƒ-preserves-Contr (Î£-preserves-family-â‰ƒ (Î» Î²a â†’ post-âˆ™-â‰ƒ (refl (f a)) (ru Î²a âˆ™ ru _))) (free-right-endpt-is-Contr _ _)))

    lemma-2 : isContr (Î£ Î´ ê‰ Ï-pres (hrefl _) (hrefl _) (hrefl _) (hrefl _) , Ï„-pres (hrefl _) (hrefl _) (hrefl _) (hrefl _) (hrefl _) (hrefl _) (hrefl _) (hrefl _) (hrefl _) Î´)
    lemma-2 = â‰ƒ-preserves-Contr
      (split , (dep-Î£-UMP A (Î» a â†’ refl (f a) â‰¡ refl _ âˆ™ refl _ âˆ™ refl _) Î» a Î´a â†’ refl _ âˆ™ (refl _ âˆ™ Î´a âˆ™ refl _ âˆ™ refl _ âˆ™ refl _ âˆ™ refl _ âˆ™ refl _) â‰¡ refl (refl (f a))))
      (Î -preserves-Contr _ (Î» a â†’ â‰ƒ-preserves-Contr (Î£-preserves-family-â‰ƒ (Î» Î´a â†’ pre-âˆ™-â‰ƒ (refl (refl (f a))) (lu _ â»Â¹ âˆ™ ru _ â»Â¹ âˆ™ ru _ â»Â¹ âˆ™ ru _ â»Â¹ âˆ™ ru _ â»Â¹ âˆ™ ru _ â»Â¹ âˆ™ lu Î´a â»Â¹))) (free-left-endpt-is-Contr _ _)))

    Contr-lemma : isContr (hae-semipres (A , A , â‰ƒ-refl A) (B , B , â‰ƒ-refl B) f f (hrefl _))
    Contr-lemma = â‰ƒ-preserves-Contr (â‰ƒ-sym (Î£-assoc _ _ _ â— Î£-over-Contr-base-is-fib _ _ lemma-1)) lemma-2

-- The corresponding forgetful functor is fully-faithful.

simple-homs : â¦ƒ fe : FunExt â¦„ â¦ƒ univ : Univalence â¦„ (Aâ‚ Aâ‚‚ : ğ“¤ Ì‡) (e : Aâ‚ â‰ƒ Aâ‚‚) (Bâ‚ Bâ‚‚ : ğ“¥ Ì‡) (e' : Bâ‚ â‰ƒ Bâ‚‚) (fâ‚ : Aâ‚ â†’ Bâ‚) (fâ‚‚ : Aâ‚‚ â†’ Bâ‚‚) â†’ hae-pres (Aâ‚ , Aâ‚‚ , e) (Bâ‚ , Bâ‚‚ , e') fâ‚ fâ‚‚ â‰ƒ (fâ‚‚ âˆ˜ prâ‚ e âˆ¼ prâ‚ e' âˆ˜ fâ‚)
simple-homs {ğ“¤} {ğ“¥} = ğ•-â‰ƒ (Î» Aâ‚ Aâ‚‚ e â†’ (Bâ‚ Bâ‚‚ : ğ“¥ Ì‡) (e' : Bâ‚ â‰ƒ Bâ‚‚) (fâ‚ : Aâ‚ â†’ Bâ‚) (fâ‚‚ : Aâ‚‚ â†’ Bâ‚‚) â†’ hae-pres (Aâ‚ , Aâ‚‚ , e) (Bâ‚ , Bâ‚‚ , e') fâ‚ fâ‚‚ â‰ƒ (fâ‚‚ âˆ˜ prâ‚ e âˆ¼ prâ‚ e' âˆ˜ fâ‚)) Î» A â†’
  ğ•-â‰ƒ (Î» Bâ‚ Bâ‚‚ e' â†’ (fâ‚ : A â†’ Bâ‚) (fâ‚‚ : A â†’ Bâ‚‚) â†’ hae-pres (A , A , â‰ƒ-refl A) (Bâ‚ , Bâ‚‚ , e') fâ‚ fâ‚‚ â‰ƒ (fâ‚‚ âˆ˜ id âˆ¼ prâ‚ e' âˆ˜ fâ‚))
  Î» B fâ‚ fâ‚‚ â†’
    Î£-of-Contr-family-is-base _ _ (ğ•-âˆ¼ (Î» fâ‚‚ fâ‚ Î± â†’ isContr (hae-semipres (A , A , â‰ƒ-refl A) (B , B , â‰ƒ-refl B) fâ‚ fâ‚‚ Î±)) (SimpleHom.Contr-lemma A B) fâ‚‚ fâ‚)

-- â„•- and â„¤-Algebra homomorphisms

â„•Hom : â„•Alg ğ“¤ â†’ â„•Alg ğ“¥ â†’ ğ“¤ âŠ” ğ“¥ Ì‡
â„•Hom (A , aâ‚€ , s) (B , bâ‚€ , s') = Î£ f ê‰ (A â†’ B) , (f aâ‚€ â‰¡ bâ‚€) Ã— (f âˆ˜ s âˆ¼ s' âˆ˜ f)

â„¤Hom : â„¤Alg ğ“¤ â†’ â„¤Alg ğ“¥ â†’ ğ“¤ âŠ” ğ“¥ Ì‡
â„¤Hom (A , aâ‚€ , s , s-is-hae) (B , bâ‚€ , s' , s'-is-hae) = Î£ f ê‰ (A â†’ B) , (f aâ‚€ â‰¡ bâ‚€) Ã— hae-pres (A , A , s , s-is-hae) (B , B , s' , s'-is-hae) f f

â„•comp : (A : â„•Alg ğ“¤) (B : â„•Alg ğ“¥) (C : â„•Alg ğ“¦) â†’ â„•Hom B C â†’ â„•Hom A B â†’ â„•Hom A C
â„•comp (A , aâ‚€ , s) (B , bâ‚€ , t)  (C , câ‚€ , u) (g , q' , Î±') (f , q , Î±) = g âˆ˜ f , (ap g q âˆ™ q') , Î» a â†’ ap g (Î± a) âˆ™ Î±' (f a) 

â„•id : (A : â„•Alg ğ“¤) â†’ â„•Hom A A
â„•id A = id , refl _ , hrefl _
 
-- Identity type of â„•-Algebra homomorphisms

â„•HomId : (A : â„•Alg ğ“¤) (B : â„•Alg ğ“¥) â†’ â„•Hom A B â†’ â„•Hom A B â†’ ğ“¤ âŠ” ğ“¥ Ì‡
â„•HomId (A , aâ‚€ , s) (B , bâ‚€ , t) (f , q , Î±) (g , q' , Î±') = Î£ H ê‰ (f âˆ¼ g) , (q â‰¡ H aâ‚€ âˆ™ q') Ã— ((a : A) â†’ Î± a âˆ™ ap t (H a) â‰¡ H (s a) âˆ™ Î±' a)

â„•Hom-â‰¡-elim : (A : â„•Alg ğ“¤) (B : â„•Alg ğ“¥) (f g : â„•Hom A B) â†’ f â‰¡ g â†’ â„•HomId A B f g
â„•Hom-â‰¡-elim A B f .f (refl .f) = hrefl _ , lu _ , Î» a â†’ ru _ â»Â¹ âˆ™ lu _ 

Î£â„•HomId-is-Contr : â¦ƒ fe : FunExt â¦„ (A : â„•Alg ğ“¤) (B : â„•Alg ğ“¥) (f : â„•Hom A B) â†’ isContr (Î£ g ê‰ â„•Hom A B , â„•HomId A B f g)
Î£â„•HomId-is-Contr (A , aâ‚€ , s) (B , bâ‚€ , t) (f , q , Î±) = â‰ƒ-preserves-Contr (â‰ƒ-sym (Î£-over-Contr-base-is-fib _ _ (â‰ƒ-preserves-Contr (Î£-preserves-family-â‰ƒ (Î» g â†’ happly , happly-is-equiv)) (free-right-endpt-is-Contr _ _ ))) â— aux-equiv) (Ã—-preserves-Contr _ _ {!!} {!!}) where
  aux-to : (Î£ w ê‰ (Î£ g ê‰ (A â†’ B) , (f âˆ¼ g)) , (Î£ q' ê‰ (prâ‚ w aâ‚€ â‰¡ bâ‚€) , (q â‰¡ prâ‚‚ w aâ‚€ âˆ™ q')) Ã— (Î£ Î±' ê‰ (prâ‚ w âˆ˜ s âˆ¼ t âˆ˜ prâ‚ w) , ((a : A) â†’ Î± a âˆ™ ap t (prâ‚‚ w a) â‰¡ prâ‚‚ w (s a) âˆ™ Î±' a))) â†’ (Î£ g ê‰ â„•Hom (A , aâ‚€ , s) (B , bâ‚€ , t) , â„•HomId (A , aâ‚€ , s) (B , bâ‚€ , t) (f , q , Î±) g)
  aux-to ((g , H) , (q' , r) , (Î±' , Î¾)) = ((g , q' , Î±') , (H , r , Î¾))
  aux-from : (Î£ g ê‰ â„•Hom (A , aâ‚€ , s) (B , bâ‚€ , t) , â„•HomId (A , aâ‚€ , s) (B , bâ‚€ , t) (f , q , Î±) g) â†’ (Î£ w ê‰ (Î£ g ê‰ (A â†’ B) , (f âˆ¼ g)) , (Î£ q' ê‰ (prâ‚ w aâ‚€ â‰¡ bâ‚€) , (q â‰¡ prâ‚‚ w aâ‚€ âˆ™ q')) Ã— (Î£ Î±' ê‰ (prâ‚ w âˆ˜ s âˆ¼ t âˆ˜ prâ‚ w) , ((a : A) â†’ Î± a âˆ™ ap t (prâ‚‚ w a) â‰¡ prâ‚‚ w (s a) âˆ™ Î±' a)))
  aux-from ((g , q' , Î±') , (H , r , Î¾)) = ((g , H) , (q' , r) , (Î±' , Î¾))
  aux-toâˆ˜from : aux-to âˆ˜ aux-from âˆ¼ id
  aux-toâˆ˜from ((g , q' , Î±') , (H , r , Î¾)) = refl _
  aux-fromâˆ˜to : aux-from âˆ˜ aux-to âˆ¼ id
  aux-fromâˆ˜to ((g , H) , (q' , r) , (Î±' , Î¾)) = refl _
  aux-equiv : (Î£ w ê‰ (Î£ g ê‰ (A â†’ B) , (f âˆ¼ g)) , (Î£ q' ê‰ (prâ‚ w aâ‚€ â‰¡ bâ‚€) , (q â‰¡ prâ‚‚ w aâ‚€ âˆ™ q')) Ã— (Î£ Î±' ê‰ (prâ‚ w âˆ˜ s âˆ¼ t âˆ˜ prâ‚ w) , ((a : A) â†’ Î± a âˆ™ ap t (prâ‚‚ w a) â‰¡ prâ‚‚ w (s a) âˆ™ Î±' a))) â‰ƒ (Î£ g ê‰ â„•Hom (A , aâ‚€ , s) (B , bâ‚€ , t) , â„•HomId (A , aâ‚€ , s) (B , bâ‚€ , t) (f , q , Î±) g)
  aux-equiv = aux-to , qinv-to-isequiv (aux-from , aux-toâˆ˜from , aux-fromâˆ˜to)


-- III. Forgetful Functor

Uâ‚€ : â„¤Alg ğ“¤ â†’ â„•Alg ğ“¤
Uâ‚€ (A , aâ‚€ , s , s-is-hae) = (A , aâ‚€ , s)

Uâ‚ : (A : â„¤Alg ğ“¤) (B : â„¤Alg ğ“¥) â†’ â„¤Hom A B â†’ â„•Hom (Uâ‚€ A) (Uâ‚€ B)
Uâ‚ A B (f , q , Î± , etc) = f , q , Î±

-- U is injective on objects

-- Uâ‚€-is-inj : (A : â„¤Alg ğ“¤) (B : â„¤Alg ğ“¥) â†’ Uâ‚€ A â‰¡ Uâ‚€ B â‰ƒ A â‰¡ B
-- Uâ‚€-is-inj = ?

-- U is Fully Faithful

U-is-FF : â¦ƒ fe : FunExt â¦„ â¦ƒ univ : Univalence â¦„ (A : â„¤Alg ğ“¤) (B : â„¤Alg ğ“¥) â†’ â„¤Hom A B â‰ƒ â„•Hom (Uâ‚€ A) (Uâ‚€ B)
U-is-FF (A , aâ‚€ , s , s-is-hae) (B , bâ‚€ , s' , s'-is-hae) = Î£-assoc _ _ _ â— Î£-preserves-family-â‰ƒ (Î£-induction (Î» f q â†’ simple-homs A A (s , s-is-hae) B B (s' , s'-is-hae) f f)) â— â‰ƒ-sym (Î£-assoc _ _ _)



-- IV. Fibered â„•- and â„¤-Algebras

Fibâ„•Alg : (ğ“¥ : Universe) â†’ â„•Alg ğ“¤ â†’ ğ“¤ âŠ” (ğ“¥ âº) Ì‡
Fibâ„•Alg ğ“¥ (A , aâ‚€ , s) = Î£ E ê‰ (A â†’ ğ“¥ Ì‡) , E aâ‚€ Ã— ((a : A) â†’ E a â†’ E (s a))





