{-# OPTIONS --without-K --exact-split #-}

open import Ch1.Type-theory
open import Ch2.1-Types-are-higher-groupoids
open import Ch2.2-Functions-are-functors
open import Ch2.3-Type-families-are-fibrations
open import Ch2.4-Homotopies-and-equivalences
open import Ch2.7-Î£-types
open import Ch2.9-Î -types-and-funext

module Ch2.10-Universes-and-univalence where


-- Lemma 2.10.1 (from identity to equivalence)

idtoeqv : (A B : ğ“¤ Ì‡) â†’ (A â‰¡ B) â†’ (A â‰ƒ B)
idtoeqv {ğ“¤} A B p =
  transport (ğ‘–ğ‘‘ (ğ“¤ Ì‡ )) p ,
  qinv-to-isequiv (â„ A (Î» B p â†’ qinv (transport (ğ‘–ğ‘‘ (ğ“¤ Ì‡)) p)) (qinv-ğ‘–ğ‘‘ A) B p)


-- Axiom 2.10.3 (Univalence)

-- (i) Definition of univalence for a given universe

is-univalent : (ğ“¤ : Universe) â†’ ğ“¤ âº Ì‡
is-univalent ğ“¤ = (X Y : ğ“¤ Ì‡ ) â†’ isequiv (idtoeqv X Y)

-- (ii) Definition of global univalence

Univalence : ğ“¤Ï‰
Univalence = âˆ€ ğ“¤ â†’ is-univalent ğ“¤

-- (iii) Postulating the axiom

postulate
  univ : Univalence


-- From equivalence to identity

ua : (A B : ğ“¤ Ì‡ ) â†’ (A â‰ƒ B) â†’ (A â‰¡ B)
ua {ğ“¤} A B = qinvâ‚ (isequiv-to-qinv (univ ğ“¤ A B))
  

-- Computation rules for univalence

idtoeqv-Î² : (A B : ğ“¤ Ì‡ ) â†’ (f : A â‰ƒ B) â†’ prâ‚ (idtoeqv A B (ua A B f)) âˆ¼ prâ‚ f
idtoeqv-Î² {ğ“¤} A B f = happly _ (prâ‚ f) (prâ‚ (dpr-â‰¡ (Î± f)))
  where
  Î± : (idtoeqv A B âˆ˜ ua A B) âˆ¼ id
  Î± = qinvâ‚‚ (isequiv-to-qinv (univ ğ“¤ A B))

idtoeqv-Î²' : (A B : ğ“¤ Ì‡ ) â†’ (idtoeqv A B âˆ˜ ua A B) âˆ¼ id
idtoeqv-Î²' {ğ“¤} A B = qinvâ‚‚ (isequiv-to-qinv (univ ğ“¤ A B))


-- Uniqueness rule for univalence

idtoeqv-Î· : (A B : ğ“¤ Ì‡ ) â†’ (ua A B âˆ˜ idtoeqv A B) âˆ¼ id
idtoeqv-Î· {ğ“¤} A B = qinvâ‚ƒ (isequiv-to-qinv (univ ğ“¤ A B))


-- Characterization of refl
  
type-refl : (A : ğ“¤ Ì‡ ) â†’ refl A â‰¡ ua A A (ğ‘–ğ‘‘ A , qinv-to-isequiv (qinv-ğ‘–ğ‘‘ A))
type-refl A = (idtoeqv-Î· _ _ (refl A)) â»Â¹ âˆ™ ap (ua A A) (refl _)

-- For _â»Â¹, _âˆ™_ and Lemma 2.10.5, it is best to use Lemma 3.5.1. See 5-Subsets-and-prop-resizing
