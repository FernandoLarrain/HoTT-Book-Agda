{-# OPTIONS --without-K --exact-split --safe #-}

module Ch2.6-Cartesian-product-types where

open import Ch1.Type-theory
open import Ch2.1-Types-are-higher-groupoids
open import Ch2.2-Functions-are-functors using (ap)
open import Ch2.3-Type-families-are-fibrations using (transport)
open import Ch2.4-Homotopies-and-equivalences using (qinv)


-- Theorem 2.6.2 (Equalities of pairs are pairs of equalities).

-- (i) From pair of equalities to equality of pairs

pair-â‰¡ : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } {x y : A Ã— B} â†’ (prâ‚ x â‰¡ prâ‚ y) Ã— (prâ‚‚ x â‰¡ prâ‚‚ y) â†’ x â‰¡ y
pair-â‰¡ {x = a , b} {.a , .b} (refl .a , refl .b) = refl (a , b)

-- (ii) Propositional uniqueness principle for pairs

Ã—-Î· : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } (z : A Ã— B) â†’ z â‰¡ (prâ‚ z , prâ‚‚ z)
Ã—-Î· z = pair-â‰¡ (refl _ , refl _)

-- (iii) From equality of pairs to pair of equalities

pr-â‰¡ : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } {x y : A Ã— B} â†’ x â‰¡ y â†’ (prâ‚ x â‰¡ prâ‚ y) Ã— (prâ‚‚ x â‰¡ prâ‚‚ y)
pr-â‰¡ r = ap prâ‚ r , ap prâ‚‚ r

-- (iv) Propositional computation rules for equality of pairs

ap-prâ‚-Î² : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } {x y : A Ã— B} (p : prâ‚ x â‰¡ prâ‚ y) (q : prâ‚‚ x â‰¡ prâ‚‚ y) â†’ ap prâ‚ (pair-â‰¡ (p , q)) â‰¡ p
ap-prâ‚-Î² {x = a , b} {y = a , b} (refl a) (refl b) = refl (refl a)

ap-prâ‚‚-Î² : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } {x y : A Ã— B} (p : prâ‚ x â‰¡ prâ‚ y) (q : prâ‚‚ x â‰¡ prâ‚‚ y) â†’ ap prâ‚‚ (pair-â‰¡ (p , q)) â‰¡ q
ap-prâ‚‚-Î² {x = a , b} {y = a , b} (refl a) (refl b) = refl (refl b)

-- (v) Propositional uniqueness principle for equality of pairs

Ã—-â‰¡-Î· : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } {x y : A Ã— B} (r : x â‰¡ y) â†’ pair-â‰¡ (ap prâ‚ r , ap prâ‚‚ r) â‰¡ r
Ã—-â‰¡-Î· {x = x} {x} (refl x) = refl (refl x)

-- (vi) Thm. 2.6.7 proper

qinv-pr-â‰¡ : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } {x y : A Ã— B} â†’ qinv pr-â‰¡
qinv-pr-â‰¡ {A = A} {B} {x} {y} = pair-â‰¡ {x = x} {y} , (Î£-induction (Î» p q â†’ pair-â‰¡ (ap-prâ‚-Î² p q , ap-prâ‚‚-Î² p q)) , Ã—-â‰¡-Î·)


-- Componentwise characterization of refl, _â»Â¹ and _âˆ™_

pair-refl : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } (z : A Ã— B) â†’ refl z â‰¡ pair-â‰¡ (refl (prâ‚ z) , refl (prâ‚‚ z))
pair-refl (a , b) = refl (refl (a , b))

pair-â»Â¹ : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } {x y : A Ã— B} (p : x â‰¡ y) â†’ p â»Â¹ â‰¡ pair-â‰¡ ((ap prâ‚ p â»Â¹) , (ap prâ‚‚ p â»Â¹))
pair-â»Â¹ (refl (a , b)) = refl (refl (a , b))

pair-âˆ™ : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } {x y z : A Ã— B} (p : x â‰¡ y) (q : y â‰¡ z) â†’ p âˆ™ q â‰¡ pair-â‰¡ ((ap prâ‚ p âˆ™ ap prâ‚ q) , (ap prâ‚‚ p âˆ™ ap prâ‚‚ q))
pair-âˆ™ (refl (a , b)) (refl (a , b)) = refl (refl (a , b))


-- Theorem 2.6.4 (Transport of pairs).

transport-pair : {Z : ğ“¤ Ì‡ } (A B : Z â†’ ğ“¥ Ì‡ ) {z w : Z} (p : z â‰¡ w) (x : A z Ã— B z) â†’ transport (Î» z â†’ A z Ã— B z) p x â‰¡ transport A p (prâ‚ x) , transport B p (prâ‚‚ x)
transport-pair A B (refl z) (a , b) = refl (a , b)


-- Theorem 2.6.5 (Functoriality of ap under products).

ap-pair : {A : ğ“¤ Ì‡ } {B : ğ“¥ Ì‡ } {A' : ğ“¦ Ì‡ } {B' : ğ“£ Ì‡ } (g : A â†’ A') (h : B â†’ B') {x y : A Ã— B} (p : prâ‚ x â‰¡ prâ‚ y) (q : prâ‚‚ x â‰¡ prâ‚‚ y) â†’ ap (Î» z â†’ g (prâ‚ z) , h (prâ‚‚ z)) (pair-â‰¡ (p , q)) â‰¡ pair-â‰¡ (ap g p , ap h q)
ap-pair g h {a , b} {a , b} (refl a) (refl b) = refl _

